---
import { getCollection, type CollectionEntry } from "astro:content";

import Layout from "../layout/Layout.astro";
import Link from "../components/Link.astro";
import { SITE } from "../config";

const posts: CollectionEntry<"blog">[] = await getCollection(
  "blog",
  ({ data }) => !data.draft
);

const yo = new Date().getFullYear() - new Date(2004, 1, 4).getFullYear();
---

<Layout>
  <h1>{SITE.author}</h1>
  <section class="description">
    <p>
      Living in <u>Brazil</u>, son of a teacher and <u>{yo}y</u>. I'm also a
      <u>software engineer</u>. In my free time, I like to <u>code</u>, learn
      something about
      <u>CS</u> or <u>philosophy</u>, care for my <u>health</u>, hang out with
      <u>friends and with my girl</u>. Here's a list of some interests:
      <ol type="i" class="desc-ol">
        <li>
          <p>
            Theory and practice about software engineering, compilers,
            interpreters, PLs, types, math, philosophy, theology
          </p>
        </li>
        <li>
          <p>
            Self improvement. Autodidactism, learning how to learn, reading,
            writing, improving my thought process. Try to practice regular
            exercises, meditation, and a healthy diet.
          </p>
        </li>
      </ol>
    </p>
  </section>
  <section class="posts">
    <h2>posts.</h2>
    <ul>
      {
        posts
          .sort(
            (a, b) =>
              Math.floor(b.data.pubDate.getTime() / 1000) -
              Math.floor(a.data.pubDate.getTime() / 1000)
          )
          .slice(0, 5)
          .map((post) => (
            <li>
              <p>{post.data.pubDate.toISOString().split("T")[0]}</p>
              <Link href={`/blog/${post.slug}`}>
                <p
                  class="post-title
                "
                >
                  {post.data.title}
                </p>
              </Link>
            </li>
          ))
      }
    </ul>

    <Link href="/blog">
      <p class="see-all-articles">see all posts...</p>
    </Link>
  </section>
</Layout>

<style>
  .desc-ol {
    padding-top: 0.5em;
    padding-left: 2em;
  }

  .desc-ol li {
    margin-bottom: 0.5em;
  }

  .posts ul {
    display: flex;
    flex-direction: column;
  }

  .posts ul li {
    display: flex;
    justify-content: space-between;
    column-gap: var(--spacing-2x);
  }

  .posts :global(a) {
    flex: 1;
  }

  .see-all-articles {
    margin-top: var(--spacing-2x);
    text-decoration: underline;
  }
</style>
